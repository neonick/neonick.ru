<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Russian Bear Analytics</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root {
  --bg: #0a0a0f;
  --card: #12121a;
  --border: #1e1e2e;
  --text: #e2e2e8;
  --text-dim: #6b6b80;
  --text-muted: #44445a;
  --amber: #f59e0b;
  --blue: #3b82f6;
  --green: #10b981;
  --purple: #8b5cf6;
  --pink: #ec4899;
  --cyan: #06b6d4;
  --red: #ef4444;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { background:var(--bg); color:var(--text); font-family:'Inter',sans-serif; min-height:100vh; line-height:1.5; }

.header { padding:28px 32px 0; border-bottom:1px solid var(--border); background:linear-gradient(180deg,var(--card) 0%,var(--bg) 100%); }
.header-top { display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; flex-wrap:wrap; gap:12px; }
.header h1 { font-family:'Space Grotesk',sans-serif; font-size:28px; font-weight:700; background:linear-gradient(135deg,var(--amber),var(--text)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; letter-spacing:-0.02em; }
.header-sub { font-size:13px; color:var(--text-dim); margin-top:4px; }
.date-badge { display:flex; flex-direction:column; gap:2px; padding:12px 16px; background:rgba(107,107,128,0.08); border-radius:10px; border:1px solid rgba(107,107,128,0.15); }
.date-badge .label { font-size:11px; color:var(--text-dim); }
.date-badge .val { font-family:'JetBrains Mono',monospace; font-size:16px; font-weight:600; color:var(--text-dim); }

.tabs { display:flex; gap:4px; overflow-x:auto; }
.tab { padding:10px 18px; border-radius:10px 10px 0 0; border:none; cursor:pointer; font-family:'Space Grotesk',sans-serif; font-size:14px; font-weight:600; transition:all 0.2s; background:transparent; color:var(--text-dim); white-space:nowrap; border-top:2px solid transparent; border-left:1px solid transparent; border-right:1px solid transparent; }
.tab:hover { color:var(--text); }
.tab.active { background:var(--bg); color:var(--amber); border-top-color:var(--amber); border-left-color:var(--border); border-right-color:var(--border); margin-bottom:-1px; }

.content { padding:28px 32px 48px; max-width:1200px; margin:0 auto; }
.tab-panel { display:none; }
.tab-panel.active { display:block; }

.grid { display:grid; gap:14px; margin-bottom:32px; }
.grid-6 { grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); }
.grid-2 { grid-template-columns:1fr 1fr; gap:24px; }
.grid-1 { grid-template-columns:1fr; gap:14px; }
@media(max-width:860px) { .grid-2 { grid-template-columns:1fr; } }

.kpi { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:20px 24px; display:flex; flex-direction:column; gap:6px; position:relative; overflow:hidden; }
.kpi .bar { position:absolute; top:0; left:0; right:0; height:3px; }
.kpi .kpi-label { font-size:13px; color:var(--text-dim); }
.kpi .kpi-value { font-family:'JetBrains Mono',monospace; font-size:28px; font-weight:700; color:var(--text); letter-spacing:-0.02em; }
.kpi .kpi-sub { font-size:12px; color:var(--text-dim); }

.stitle { margin-bottom:20px; margin-top:8px; }
.stitle h2 { font-family:'Space Grotesk',sans-serif; font-size:22px; font-weight:700; color:var(--text); letter-spacing:-0.01em; }

.card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:24px; }
.mb-28 { margin-bottom:28px; }
.mb-32 { margin-bottom:32px; }

/* Chart container — fixed height, relative positioning for Chart.js */
.chart-box { position:relative; width:100%; }

.mini { display:inline-flex; flex-direction:column; gap:2px; padding:12px 16px; border-radius:10px; background:rgba(107,107,128,0.08); border:1px solid rgba(107,107,128,0.15); }
.mini .ml { font-size:11px; color:var(--text-dim); }
.mini .mv { font-family:'JetBrains Mono',monospace; font-size:16px; font-weight:600; }

.progress { height:8px; background:var(--border); border-radius:4px; overflow:hidden; margin-bottom:8px; }
.progress-fill { height:100%; border-radius:4px; }

.channel { margin-bottom:20px; }
.channel:last-of-type { margin-bottom:0; }
.ch-head { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.ch-name { font-family:'Space Grotesk',sans-serif; font-size:16px; font-weight:600; }
.ch-rev { font-family:'JetBrains Mono',monospace; font-size:18px; font-weight:700; }
.ch-minis { display:flex; gap:12px; flex-wrap:wrap; }
.cross-ch { margin-top:20px; padding:12px 16px; border-radius:10px; background:rgba(6,182,212,0.06); border:1px solid rgba(6,182,212,0.15); font-size:12px; color:var(--cyan); }

.insight { border-radius:14px; padding:18px 22px; display:flex; gap:14px; align-items:flex-start; }
.insight .it { font-family:'Space Grotesk',sans-serif; font-weight:600; font-size:15px; margin-bottom:6px; }
.insight .ix { font-size:13px; color:var(--text-dim); line-height:1.6; }
.insight .num { font-family:'JetBrains Mono',monospace; font-size:20px; font-weight:700; flex-shrink:0; margin-top:2px; width:28px; text-align:center; }
.i-info { background:rgba(59,130,246,0.03); border:1px solid rgba(59,130,246,0.19); } .i-info .it, .i-info .num { color:var(--blue); }
.i-warn { background:rgba(245,158,11,0.03); border:1px solid rgba(245,158,11,0.19); } .i-warn .it, .i-warn .num { color:var(--amber); }
.i-ok { background:rgba(16,185,129,0.03); border:1px solid rgba(16,185,129,0.19); } .i-ok .it, .i-ok .num { color:var(--green); }
.i-alert { background:rgba(239,68,68,0.03); border:1px solid rgba(239,68,68,0.19); } .i-alert .it, .i-alert .num { color:var(--red); }
.i-purple { background:rgba(139,92,246,0.03); border:1px solid rgba(139,92,246,0.19); } .i-purple .it, .i-purple .num { color:var(--purple); }

.tw { overflow-x:auto; }
table { width:100%; border-collapse:collapse; font-size:13px; }
th { padding:10px 12px; text-align:left; color:var(--text-dim); font-weight:500; font-size:11px; text-transform:uppercase; letter-spacing:0.05em; border-bottom:1px solid var(--border); }
td { padding:12px; border-bottom:1px solid rgba(30,30,46,0.13); }
.mono { font-family:'JetBrains Mono',monospace; } .fw6 { font-weight:600; }
.ca { color:var(--amber); } .cb { color:var(--blue); } .cg { color:var(--green); } .cp { color:var(--purple); } .cd { color:var(--text-dim); } .cm { color:var(--text-muted); }
.badge { padding:3px 10px; border-radius:20px; font-size:11px; font-weight:600; display:inline-block; }
.pie-legend { display:flex; flex-wrap:wrap; gap:12px; justify-content:center; margin-top:12px; font-size:12px; }
.pie-dot { width:10px; height:10px; border-radius:3px; display:inline-block; vertical-align:middle; margin-right:4px; }
.note { margin-top:10px; font-size:12px; color:var(--text-dim); }
.note-c { text-align:center; }

.cpr { display:flex; justify-content:space-between; align-items:center; padding:10px 0; border-bottom:1px solid rgba(30,30,46,0.13); }
.cpr:last-of-type { border-bottom:none; }
.cpb { display:flex; align-items:center; gap:8px; }
.cpf { height:6px; background:var(--purple); border-radius:3px; }
.cpv { font-family:'JetBrains Mono',monospace; font-size:13px; color:var(--purple); font-weight:600; min-width:30px; text-align:right; }

.cond { margin-bottom:20px; } .cond:last-child { margin-bottom:0; }
.cond-h { display:flex; justify-content:space-between; margin-bottom:6px; }
.cond-n { font-family:'Space Grotesk',sans-serif; font-size:15px; font-weight:600; }
.cond-p { font-family:'JetBrains Mono',monospace; font-size:15px; font-weight:600; }
.cond-bar { height:10px; background:var(--border); border-radius:5px; overflow:hidden; margin-bottom:8px; }
.cond-f { height:100%; border-radius:5px; }
.cond-m { display:flex; gap:12px; }
</style>
</head>
<body>

<div class="header">
  <div class="header-top">
    <div><h1>Russian Bear Analytics</h1><p class="header-sub">BricksApp · Апрель 2025 — Февраль 2026</p></div>
    <div class="date-badge"><span class="label">Сегодня</span><span class="val">16 фев 2026</span></div>
  </div>
  <div class="tabs">
    <button class="tab active" data-tab="overview">Обзор</button>
    <button class="tab" data-tab="dynamics">Динамика</button>
    <button class="tab" data-tab="buyers">Покупатели</button>
    <button class="tab" data-tab="products">Товары</button>
    <button class="tab" data-tab="patterns">Паттерны</button>
    <button class="tab" data-tab="insights">Инсайты</button>
  </div>
</div>

<div class="content">

<!-- ======== OVERVIEW ======== -->
<div class="tab-panel active" id="panel-overview">
  <div class="stitle"><h2>Ключевые показатели</h2></div>
  <div class="grid grid-6 mb-32">
    <div class="kpi"><div class="bar" style="background:linear-gradient(90deg,var(--amber),transparent)"></div><div class="kpi-label">Общая выручка</div><div class="kpi-value">1 027 451 ₽</div><div class="kpi-sub">за всё время</div></div>
    <div class="kpi"><div class="bar" style="background:linear-gradient(90deg,var(--blue),transparent)"></div><div class="kpi-label">Заказов</div><div class="kpi-value">657</div><div class="kpi-sub">45 463 штук продано</div></div>
    <div class="kpi"><div class="bar" style="background:linear-gradient(90deg,var(--green),transparent)"></div><div class="kpi-label">Средний чек</div><div class="kpi-value">1 564 ₽</div></div>
    <div class="kpi"><div class="bar" style="background:linear-gradient(90deg,var(--purple),transparent)"></div><div class="kpi-label">Покупателей</div><div class="kpi-value">354</div><div class="kpi-sub">125 повторных (35,3%)</div></div>
    <div class="kpi"><div class="bar" style="background:linear-gradient(90deg,var(--pink),transparent)"></div><div class="kpi-label">Повторные → выручка</div><div class="kpi-value">73,3%</div><div class="kpi-sub">753 489 ₽</div></div>
    <div class="kpi"><div class="bar" style="background:linear-gradient(90deg,var(--cyan),transparent)"></div><div class="kpi-label">Прогноз февраля</div><div class="kpi-value">73 339 ₽</div><div class="kpi-sub">Факт: 41 908 ₽ за 16 дн.</div></div>
  </div>

  <div class="grid grid-2 mb-32">
    <div>
      <div class="stitle"><h2>Структура выручки</h2></div>
      <div class="card">
        <div class="chart-box" style="height:260px"><canvas id="pieRevType"></canvas></div>
        <div class="pie-legend">
          <span><span class="pie-dot" style="background:var(--amber)"></span><span class="cd">Детали </span><span class="ca mono fw6">64,8%</span></span>
          <span><span class="pie-dot" style="background:var(--blue)"></span><span class="cd">Минифигурки </span><span class="cb mono fw6">32,7%</span></span>
          <span><span class="pie-dot" style="background:var(--green)"></span><span class="cd">Наборы </span><span class="cg mono fw6">2,1%</span></span>
          <span><span class="pie-dot" style="background:var(--purple)"></span><span class="cd">Инструкции </span><span class="cp mono fw6">0,5%</span></span>
        </div>
      </div>
    </div>
    <div>
      <div class="stitle"><h2>Каналы продаж</h2></div>
      <div class="card">
        <div class="channel">
          <div class="ch-head"><span class="ch-name">BricksApp</span><span class="ch-rev cg">532 314 ₽</span></div>
          <div class="progress"><div class="progress-fill" style="width:51.8%;background:var(--green)"></div></div>
          <div class="ch-minis">
            <div class="mini"><span class="ml">Заказов</span><span class="mv cd">382</span></div>
            <div class="mini"><span class="ml">Ср. чек</span><span class="mv cd">1 394 ₽</span></div>
            <div class="mini"><span class="ml">Доля</span><span class="mv cd">51,8%</span></div>
          </div>
        </div>
        <div class="channel">
          <div class="ch-head"><span class="ch-name">Авито</span><span class="ch-rev ca">495 137 ₽</span></div>
          <div class="progress"><div class="progress-fill" style="width:48.2%;background:var(--amber)"></div></div>
          <div class="ch-minis">
            <div class="mini"><span class="ml">Заказов</span><span class="mv cd">275</span></div>
            <div class="mini"><span class="ml">Ср. чек</span><span class="mv cd">1 800 ₽</span></div>
            <div class="mini"><span class="ml">Доля</span><span class="mv cd">48,2%</span></div>
          </div>
        </div>
        <div class="cross-ch">52 покупателя заказывают на обеих площадках</div>
      </div>
    </div>
  </div>
</div>

<!-- ======== DYNAMICS ======== -->
<div class="tab-panel" id="panel-dynamics">
  <div class="stitle"><h2>Выручка по месяцам</h2></div>
  <div class="card mb-28"><div class="chart-box" style="height:300px"><canvas id="chartRevMonth"></canvas></div></div>

  <div class="stitle"><h2>Заказы и новые покупатели</h2></div>
  <div class="card mb-28"><div class="chart-box" style="height:280px"><canvas id="chartOrdersBuyers"></canvas></div></div>

  <div class="stitle"><h2>Средний чек по месяцам</h2></div>
  <div class="card mb-28"><div class="chart-box" style="height:260px"><canvas id="chartAvgCheck"></canvas></div></div>

  <div class="stitle"><h2>Рост месяц-к-месяцу</h2></div>
  <div class="card"><div class="chart-box" style="height:240px"><canvas id="chartMoM"></canvas></div><div class="note note-c">Июн — Авг (+1210%) исключён: скачок после паузы в июле</div></div>
</div>

<!-- ======== BUYERS ======== -->
<div class="tab-panel" id="panel-buyers">
  <div class="stitle"><h2>Топ-10 покупателей</h2></div>
  <div class="card mb-28 tw"><table><thead><tr><th>#</th><th>Покупатель</th><th>Тип</th><th>Заказы</th><th>Выручка</th><th>Штук</th><th>Ср. чек</th></tr></thead><tbody id="buyersTable"></tbody></table></div>

  <div class="grid grid-2 mb-28">
    <div>
      <div class="stitle"><h2>Повторные vs Разовые (кол-во)</h2></div>
      <div class="card">
        <div class="chart-box" style="height:220px"><canvas id="pieBuyerCount"></canvas></div>
        <div class="pie-legend"><span class="cd">Разовые: 229 (64,7%)</span><span class="cg">Повторные: 125 (35,3%)</span></div>
      </div>
    </div>
    <div>
      <div class="stitle"><h2>Повторные vs Разовые (выручка)</h2></div>
      <div class="card">
        <div class="chart-box" style="height:220px"><canvas id="pieBuyerRev"></canvas></div>
        <div class="pie-legend"><span class="cd">Разовые: 273 962 ₽ (26,7%)</span><span class="ca">Повторные: 753 489 ₽ (73,3%)</span></div>
      </div>
    </div>
  </div>

  <div class="stitle"><h2>Когорты: новые покупатели</h2></div>
  <div class="card mb-28"><div class="chart-box" style="height:240px"><canvas id="chartCohort"></canvas></div></div>

  <div class="stitle"><h2>Ключевые покупатели</h2></div>
  <div class="grid grid-2" style="gap:16px">
    <div class="insight i-alert"><div><div class="it">shop-device — 69 271 ₽</div><div class="ix">Магазин-конкурент. 4 заказа со средним чеком 17 318 ₽. Покупает минифигурки для перепродажи. Плюс: выручка. Минус: конкурент наращивает ассортимент за ваш счёт.</div></div></div>
    <div class="insight i-info"><div><div class="it">brick stone — 56 452 ₽</div><div class="ix">MOC-строитель. 1 069 деталей за 4 заказа. Берёт большие партии базовых деталей. Средний чек 14 113 ₽ — один из самых ценных клиентов.</div></div></div>
    <div class="insight i-warn"><div><div class="it">m.m.72 — 28 625 ₽ (26 заказов)</div><div class="ix">Самый лояльный покупатель. 26 заказов, 4 846 деталей. Скромный средний чек 1 101 ₽, но стабильность поражает. Идеальный кандидат на персональную скидку.</div></div></div>
    <div class="insight i-purple"><div><div class="it">n3onov.m — 25 658 ₽</div><div class="ix">Всего 2 заказа, но на 440 деталей. Средний чек 12 829 ₽ — либо крупный строитель, либо оптовик. Стоит удержать персональным предложением.</div></div></div>
  </div>
</div>

<!-- ======== PRODUCTS ======== -->
<div class="tab-panel" id="panel-products">
  <div class="stitle"><h2>Топ товаров по количеству заказов</h2></div>
  <div class="card mb-28 tw">
    <table><thead><tr><th>#</th><th>Деталь</th><th>Заказов</th><th>Продано шт.</th><th>Выручка</th></tr></thead><tbody id="itemsTable"></tbody></table>
    <div class="note">970c00 — ноги минифигурок — лидер спроса. Стабильная потребность во всех цветах.</div>
  </div>

  <div class="grid grid-2 mb-28">
    <div>
      <div class="stitle"><h2>Минифигурки: ценовые сегменты</h2></div>
      <div class="card"><div class="chart-box" style="height:250px"><canvas id="chartMinifigSeg"></canvas></div><div class="note note-c">74,7% минифигурок продаются в диапазоне 100–500 ₽</div></div>
    </div>
    <div>
      <div class="stitle"><h2>Распределение заказов по сумме</h2></div>
      <div class="card"><div class="chart-box" style="height:250px"><canvas id="chartOrderSize"></canvas></div><div class="note note-c">Сегмент 2k–5k — основной по выручке (335 461 ₽)</div></div>
    </div>
  </div>
</div>

<!-- ======== PATTERNS ======== -->
<div class="tab-panel" id="panel-patterns">
  <div class="grid grid-2 mb-28">
    <div>
      <div class="stitle"><h2>Заказы по дням недели</h2></div>
      <div class="card"><div class="chart-box" style="height:260px"><canvas id="chartDOW"></canvas></div><div class="note note-c">Вторник — пик заказов (104). Выходные не уступают будням.</div></div>
    </div>
    <div>
      <div class="stitle"><h2>Заказы по часам (МСК)</h2></div>
      <div class="card"><div class="chart-box" style="height:260px"><canvas id="chartHour"></canvas></div><div class="note note-c">Два пика: 17:00 (51) и 21:00 (49). Заказывают после работы.</div></div>
    </div>
  </div>

  <div class="stitle"><h2>Доставка</h2></div>
  <div class="card mb-28 tw"><table><thead><tr><th>Способ</th><th>Заказов</th><th>Выручка</th><th>Ср. чек</th></tr></thead><tbody id="shippingTable"></tbody></table></div>

  <div class="grid grid-2 mb-28">
    <div>
      <div class="stitle"><h2>Что покупают вместе</h2></div>
      <div class="card" id="coPurchaseCard"></div>
    </div>
    <div>
      <div class="stitle"><h2>Состояние товаров</h2></div>
      <div class="card">
        <div class="cond">
          <div class="cond-h"><span class="cond-n">Б/У</span><span class="cond-p cb">98,5%</span></div>
          <div class="cond-bar"><div class="cond-f" style="width:98.5%;background:var(--blue)"></div></div>
          <div class="cond-m"><div class="mini"><span class="ml">Штук</span><span class="mv cd">45 119</span></div><div class="mini"><span class="ml">Выручка</span><span class="mv cd">977 573 ₽</span></div></div>
        </div>
        <div class="cond">
          <div class="cond-h"><span class="cond-n">Новые</span><span class="cond-p cg">1,5%</span></div>
          <div class="cond-bar"><div class="cond-f" style="width:1.5%;background:var(--green)"></div></div>
          <div class="cond-m"><div class="mini"><span class="ml">Штук</span><span class="mv cd">344</span></div><div class="mini"><span class="ml">Выручка</span><span class="mv cd">14 099 ₽</span></div></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ======== INSIGHTS ======== -->
<div class="tab-panel" id="panel-insights">
  <div class="stitle"><h2>Ключевые находки</h2></div>
  <div class="grid grid-2 mb-28" style="gap:16px">
    <div class="insight i-alert"><div><div class="it">Конкурент shop-device закупается у вас</div><div class="ix">shop-device — топ-1 покупатель с выручкой 69 271 ₽. Покупает минифигурки для перепродажи. Это 6,7% всей выручки. Плюс для кассы, но ваши цены для него — «оптовая база».</div></div></div>
    <div class="insight i-ok"><div><div class="it">35% повторных дают 73% выручки</div><div class="ix">125 лояльных покупателей генерируют три четверти дохода. Каждый повторный в среднем приносит 6 028 ₽ vs 1 196 ₽ у разового — разница в 5 раз.</div></div></div>
    <div class="insight i-ok"><div><div class="it">Январь 2026 — рекорд по заказам</div><div class="ix">123 заказа, 167 305 ₽ выручки. Количество заказов растёт, средний чек снижается (с 2 330 ₽ в августе до 1 360 ₽). Переход от «мало дорогих» к «много стабильных» — здоровая динамика.</div></div></div>
    <div class="insight i-info"><div><div class="it">BricksApp догоняет Авито</div><div class="ix">BricksApp: 532 314 ₽ (58% заказов). Авито: 495 137 ₽ (42%, но средний чек выше — 1 800 ₽ vs 1 394 ₽). 52 покупателя пользуются обоими — воронка работает.</div></div></div>
    <div class="insight i-warn"><div><div class="it">Ноги минифигурок (970c00) — хит №1</div><div class="ix">27 заказов в разных цветах. Самый универсальный товар: нужен всем, кто собирает минифигурки. Держать в наличии все популярные цвета.</div></div></div>
    <div class="insight i-purple"><div><div class="it">Ночные покупатели — 15% заказов</div><div class="ix">С 23:00 до 02:00 МСК оформляется ~100 заказов. Публикация новинок в 22:00 может увеличить конверсию.</div></div></div>
  </div>

  <div class="stitle"><h2>Рекомендации</h2></div>
  <div class="grid grid-1" style="gap:14px">
    <div class="insight i-alert"><div class="num">1</div><div><div class="it">Решить вопрос с shop-device</div><div class="ix">69 271 ₽ — серьёзно. Варианты: 1) ничего не менять и считать оптовым каналом, 2) наценка 10-15% для крупных заказов на минифигурки, 3) ценовая вилка (розница/опт). Блокировка = потеря 6,7% выручки.</div></div></div>
    <div class="insight i-warn"><div class="num">2</div><div><div class="it">Программа лояльности для топ-20</div><div class="ix">20 покупателей дают 45% выручки. Персональные скидки 5-7%, ранний доступ к новинкам, бесплатная доставка от 3 000 ₽. Начните с m.m.72 (26 заказов) — он заслужил VIP-статус.</div></div></div>
    <div class="insight i-ok"><div class="num">3</div><div><div class="it">Пополнить 970c00, 3023, 30374</div><div class="ix">Топ-3 детали по спросу. Каждый цвет — отдельная позиция. Чёрные ноги (970c00 color 11) — 27 заказов, дефицит стоит денег.</div></div></div>
    <div class="insight i-info"><div class="num">4</div><div><div class="it">Вечерние публикации новинок</div><div class="ix">Пик заказов: 17:00 и 21:00. Публикуйте новинки и акции в Telegram-канале в 16:30–17:00 и 20:00–20:30.</div></div></div>
    <div class="insight i-purple"><div class="num">5</div><div><div class="it">Бандлы «Детали + Минифигурка»</div><div class="ix">34,5% заказов содержат оба типа. Готовые комплекты со скидкой 5% повысят средний чек и ускорят оборот минифигурок.</div></div></div>
  </div>
</div>

</div>

<script>
// ===== TABS =====
document.querySelectorAll('.tab').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('panel-' + btn.dataset.tab).classList.add('active');
    // Trigger resize so Chart.js recalculates hidden canvases
    setTimeout(() => window.dispatchEvent(new Event('resize')), 60);
  });
});

// ===== CHART.JS DEFAULTS =====
Chart.defaults.color = '#6b6b80';
Chart.defaults.borderColor = '#1e1e2e';
Chart.defaults.font.family = "'Inter',sans-serif";
Chart.defaults.font.size = 12;
Chart.defaults.plugins.legend.display = false;
Chart.defaults.plugins.tooltip.backgroundColor = '#12121a';
Chart.defaults.plugins.tooltip.borderColor = '#1e1e2e';
Chart.defaults.plugins.tooltip.borderWidth = 1;
Chart.defaults.plugins.tooltip.cornerRadius = 10;
Chart.defaults.plugins.tooltip.titleFont = { family:"'Inter',sans-serif", size:12 };
Chart.defaults.plugins.tooltip.bodyFont = { family:"'JetBrains Mono',monospace", size:13 };
Chart.defaults.plugins.tooltip.padding = 10;

const fN = n => Number(n).toLocaleString('ru-RU');
const fK = n => (n/1000).toFixed(0)+'k';
// All charts use responsive:true + maintainAspectRatio:false so they fill their .chart-box container
const R = { responsive:true, maintainAspectRatio:false };
const G = { color:'#1e1e2e' }; // grid line color

// ===== OVERVIEW: Pie =====
new Chart(document.getElementById('pieRevType'), {
  type:'doughnut',
  data:{ labels:['Детали','Минифигурки','Наборы','Инструкции'], datasets:[{ data:[642102,323775,20990,4646], backgroundColor:['#f59e0b','#3b82f6','#10b981','#8b5cf6'], borderWidth:0, borderRadius:4 }] },
  options:{ ...R, cutout:'55%', plugins:{ tooltip:{ callbacks:{ label:c=>fN(c.raw)+' ₽' } } } }
});

// ===== DYNAMICS =====
const M = ['Апр 25','Май 25','Июн 25','Авг 25','Сен 25','Окт 25','Ноя 25','Дек 25','Янв 26','Фев 26*'];

new Chart(document.getElementById('chartRevMonth'), {
  type:'line',
  data:{ labels:M, datasets:[{ data:[33235,90179,15291,200355,96779,91748,133938,156713,167305,41908], borderColor:'#f59e0b', backgroundColor:'rgba(245,158,11,0.1)', fill:true, tension:0.3, pointRadius:5, pointBackgroundColor:'#f59e0b', pointBorderWidth:0, borderWidth:2.5 }] },
  options:{ ...R, scales:{ y:{ ticks:{ callback:v=>fK(v) }, grid:G }, x:{ grid:G } }, plugins:{ tooltip:{ callbacks:{ label:c=>fN(c.raw)+' ₽' } } } }
});

new Chart(document.getElementById('chartOrdersBuyers'), {
  type:'bar',
  data:{ labels:M, datasets:[{ label:'Заказы', data:[16,55,6,86,70,85,84,96,123,36], backgroundColor:'#3b82f6', borderRadius:4 },{ label:'Новые покупатели', data:[12,45,4,58,38,40,39,37,62,19], backgroundColor:'#10b981', borderRadius:4 }] },
  options:{ ...R, scales:{ y:{ grid:G }, x:{ grid:G } }, plugins:{ legend:{ display:true, labels:{ color:'#6b6b80', font:{ family:"'Inter',sans-serif", size:12 } } } } }
});

new Chart(document.getElementById('chartAvgCheck'), {
  type:'line',
  data:{ labels:M, datasets:[{ data:[2077,1640,2548,2330,1383,1079,1595,1632,1360,1164], borderColor:'#8b5cf6', backgroundColor:'transparent', tension:0.3, pointRadius:5, pointBackgroundColor:'#8b5cf6', pointBorderWidth:0, borderWidth:2.5 }] },
  options:{ ...R, scales:{ y:{ min:0, max:3000, grid:G }, x:{ grid:G } }, plugins:{ tooltip:{ callbacks:{ label:c=>fN(c.raw)+' ₽' } } } }
});

const momV = [171.3,-83.0,-51.7,-5.2,46.0,17.0,6.8];
new Chart(document.getElementById('chartMoM'), {
  type:'bar',
  data:{ labels:['Апр-Май','Май-Июн','Авг-Сен','Сен-Окт','Окт-Ноя','Ноя-Дек','Дек-Янв'], datasets:[{ data:momV, backgroundColor:momV.map(v=>v>=0?'#10b981':'#ef4444'), borderRadius:4 }] },
  options:{ ...R, scales:{ y:{ ticks:{ callback:v=>v+'%' }, grid:G }, x:{ grid:G } }, plugins:{ tooltip:{ callbacks:{ label:c=>(c.raw>0?'+':'')+c.raw.toFixed(1)+'%' } } } }
});

// ===== BUYERS =====
const BD = [
  {n:'shop-device',o:4,r:69271,q:192,a:17318,t:'Магазин',cv:'--red'},
  {n:'brick stone',o:4,r:56452,q:1069,a:14113,t:'MOC-строитель',cv:'--blue'},
  {n:'Йорн Парсиль',o:5,r:33421,q:514,a:6684,t:'VIP',cv:'--amber'},
  {n:'m.m.72',o:26,r:28625,q:4846,a:1101,t:'VIP',cv:'--amber'},
  {n:'n3onov.m',o:2,r:25658,q:440,a:12829,t:'Крупный',cv:'--purple'},
  {n:'evg_go',o:11,r:23846,q:296,a:2168,t:'VIP',cv:'--amber'},
  {n:'dmuodin',o:11,r:22936,q:1764,a:2085,t:'VIP',cv:'--amber'},
  {n:'kauha',o:2,r:21024,q:1909,a:10512,t:'Крупный',cv:'--purple'},
  {n:'korpusovdenis',o:10,r:19861,q:1262,a:1986,t:'VIP',cv:'--amber'},
  {n:'Екатерина',o:2,r:18469,q:547,a:9234,t:'Крупный',cv:'--purple'},
];
const bT=document.getElementById('buyersTable');
BD.forEach((b,i)=>{bT.innerHTML+=`<tr><td class="mono fw6 cm">${i+1}</td><td class="fw6">${b.n}</td><td><span class="badge" style="color:var(${b.cv});background:color-mix(in srgb,var(${b.cv}) 12%,transparent);border:1px solid color-mix(in srgb,var(${b.cv}) 30%,transparent)">${b.t}</span></td><td class="mono">${b.o}</td><td class="mono fw6 ca">${fN(b.r)} ₽</td><td class="mono cd">${fN(b.q)}</td><td class="mono cd">${fN(b.a)} ₽</td></tr>`;});

new Chart(document.getElementById('pieBuyerCount'), {
  type:'doughnut',
  data:{ labels:['Разовые','Повторные'], datasets:[{ data:[229,125], backgroundColor:['#44445a','#10b981'], borderWidth:0 }] },
  options:{ ...R, cutout:'55%', plugins:{ tooltip:{ callbacks:{ label:c=>c.raw+' чел.' } } } }
});

new Chart(document.getElementById('pieBuyerRev'), {
  type:'doughnut',
  data:{ labels:['Разовые','Повторные'], datasets:[{ data:[273962,753489], backgroundColor:['#44445a','#f59e0b'], borderWidth:0 }] },
  options:{ ...R, cutout:'55%', plugins:{ tooltip:{ callbacks:{ label:c=>fN(c.raw)+' ₽' } } } }
});

new Chart(document.getElementById('chartCohort'), {
  type:'bar',
  data:{ labels:M, datasets:[{ data:[12,45,4,58,38,40,39,37,62,19], backgroundColor:'#06b6d4', borderRadius:4 }] },
  options:{ ...R, scales:{ y:{ grid:G }, x:{ grid:G } } }
});

// ===== PRODUCTS =====
const ID = [
  {n:'970c00 (чёрн.)',o:27,q:100,r:2000},{n:'3023 (чёрн.)',o:18,q:192,r:576},
  {n:'30374 (кор.)',o:17,q:53,r:930},{n:'3023 (свет.-сер.)',o:17,q:148,r:444},
  {n:'970c00 (тём.-сер.)',o:17,q:52,r:1040},{n:'30374 (бел.)',o:16,q:37,r:316},
  {n:'970c00 (тём.-кор.)',o:15,q:41,r:820},{n:'970c00 (кр.)',o:15,q:28,r:560},
  {n:'3020 (тём.-сер.)',o:14,q:78,r:234},{n:'970c00 (син.)',o:13,q:49,r:735},
  {n:'3626 (жёлт.)',o:13,q:16,r:400},{n:'3069 (бел.)',o:12,q:62,r:248},
  {n:'970c00 (тём.-фиол.)',o:12,q:16,r:608},{n:'58247 (чёрн.)',o:12,q:89,r:1780},
];
const iT=document.getElementById('itemsTable');
ID.forEach((x,i)=>{iT.innerHTML+=`<tr><td class="mono cm">${i+1}</td><td class="mono fw6" style="font-size:12px">${x.n}</td><td class="mono fw6 cb">${x.o}</td><td class="mono cd">${fN(x.q)}</td><td class="mono ca">${fN(x.r)} ₽</td></tr>`;});

new Chart(document.getElementById('chartMinifigSeg'), {
  type:'bar',
  data:{ labels:['<100 ₽','100–500 ₽','500–1k ₽','1k–2k ₽','2000+ ₽'], datasets:[{ data:[68,630,94,33,19], backgroundColor:'#ec4899', borderRadius:4 }] },
  options:{ ...R, indexAxis:'y', scales:{ x:{ grid:G }, y:{ grid:{ display:false } } }, plugins:{ tooltip:{ callbacks:{ label:c=>c.raw+' шт.' } } } }
});

new Chart(document.getElementById('chartOrderSize'), {
  type:'bar',
  data:{ labels:['<300','300-500','500-1k','1k-2k','2k-5k','5k+'], datasets:[{ data:[100,79,201,132,116,29], backgroundColor:'#3b82f6', borderRadius:4 }] },
  options:{ ...R, scales:{ y:{ grid:G }, x:{ grid:G } } }
});

// ===== PATTERNS =====
new Chart(document.getElementById('chartDOW'), {
  type:'bar',
  data:{
    labels:['Пн','Вт','Ср','Чт','Пт','Сб','Вс'],
    datasets:[{
      label:'Заказы',
      data:[93,104,98,99,87,90,86],
      backgroundColor:'#3b82f6',
      borderRadius:4,
      barPercentage:0.6,
      categoryPercentage:0.7
    }]
  },
  options:{
    ...R,
    scales:{
      y:{ beginAtZero:true, grid:G, ticks:{ font:{ family:"'JetBrains Mono',monospace", size:11 } } },
      x:{ grid:{ display:false }, ticks:{ font:{ family:"'Inter',sans-serif", size:12 } } }
    }
  }
});

new Chart(document.getElementById('chartHour'), {
  type:'line',
  data:{ labels:['00','01','02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23'], datasets:[{ data:[36,24,14,8,5,4,2,7,10,19,24,41,32,36,30,41,35,51,33,44,39,49,32,41], borderColor:'#06b6d4', backgroundColor:'rgba(6,182,212,0.1)', fill:true, tension:0.3, pointRadius:0, borderWidth:2 }] },
  options:{ ...R, scales:{ y:{ grid:G }, x:{ grid:G, ticks:{ maxTicksLimit:12 } } } }
});

// Shipping table
[['OZON',303,356613,1177],['Авито — Яндекс',145,302730,2088],['Авито — ПВЗ',96,144712,1507],['Самовывоз',41,72505,1768],['Авито — Почта',34,47694,1403],['Яндекс Доставка',26,79059,3041],['Почта России',12,24137,2011]].forEach(s=>{document.getElementById('shippingTable').innerHTML+=`<tr><td class="fw6">${s[0]}</td><td class="mono cb">${fN(s[1])}</td><td class="mono ca">${fN(s[2])} ₽</td><td class="mono cg">${fN(s[3])} ₽</td></tr>`;});

// Co-purchase
const cpE=document.getElementById('coPurchaseCard');
[['Минифигурки + Детали',227],['Инструкции + Детали',41],['Наборы + Детали',24],['Минифигурки + Наборы',20],['Инструкции + Минифигурки',20]].forEach(c=>{cpE.innerHTML+=`<div class="cpr"><span style="font-size:13px">${c[0]}</span><div class="cpb"><div class="cpf" style="width:${Math.max(20,c[1]/2.5)}px"></div><span class="cpv">${c[1]}</span></div></div>`;});
cpE.innerHTML+=`<div class="note">227 заказов содержат и детали, и минифигурки — это 34,5% всех заказов</div>`;
</script>
</body>
</html>
